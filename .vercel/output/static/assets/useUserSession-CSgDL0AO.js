import{r as e,h,a2 as S,k as g}from"./index-QrBDpgyu.js";const E="/api/me",y=({redirectTo:t=""})=>{const[i,a]=e.useState(null),[f,o]=e.useState(!1),[l,n]=e.useState(!1),c=h(),r=e.useCallback(async()=>{try{const s=(await S.get(E)).data;a(s),n(!1)}catch(s){throw console.error("Failed to get session:",s),s}},[]);return e.useEffect(()=>{(async()=>{o(!0);try{await r()}catch{try{await g.refreshToken(),await r()}catch(u){console.error("Failed to refresh token or get session after refresh:",u),n(!0),a(null),t&&c(t)}}finally{o(!1)}})()},[c,t,r]),{user:i,isLoading:f,isError:l}};export{y as u};
